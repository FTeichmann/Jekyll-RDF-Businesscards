<nav class="navbar navbar-toggleable-md navbar-light nav-tabs bg-faded">
    <img src="http://aksw.org/extensions/site/sites//local/images/logo-aksw.png" width="auto" height="auto" alt="AKSW">
    <ul class="navbar-nav mr-auto">
        <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
        </li>
        {% assign count = 0 %}
        {% capture query %}
        # select all main Navigation position properties for counting
        SELECT ?position WHERE{
            ex:Mainnav ?positionProp ?resource .
            ?positionProp a rdfs:ContainerMembershipProperty .
            ?positionProp rdfs:label ?position .
        }
        {% endcapture %}
        {% assign resultset = page.rdf | sparql_query: query %}
        {% for result in resultset %}
            {% assign count = count | plus : 1 %}
            {% capture query2 %}
            # select menu entry for current count
            SELECT ?resource ?label WHERE{
                ex:Mainnav ?positionProp ?resource .
                ?positionProp a rdfs:ContainerMembershipProperty .
                ?positionProp rdfs:label "{{count}}" .
                ?resource a foaf:Document .
                ?resource rdfs:label ?label .
            }
            {% endcapture %}
            {% assign resultset2 = page.rdf | sparql_query: query2 %}
            {% for result2 in resultset2 %}
                {% for page in site.pages %}
                    {% if page.rdf.iri == result2.resource.iri %}
                    <li class="nav-item btn-group">
                        <a class="nav-link" href="{{ page.url }}">
                            {{ result2.label }}
                        </a>
                        {% capture query3 %}
                        SELECT ?resource ?name WHERE{
                        <{{ result2.resource }}> ?positionProp ?resource .
                        ?positionProp a rdfs:ContainerMembershipProperty .
                        ?resource rdfs:label ?name .
                        }
                        {% endcapture %}
                        {% assign resultset3 = page.rdf | sparql_query: query3 %}
                        {% if resultset3.size > 0 %}
                        <button type="button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
                        <div class="dropdown-menu">
                        {% for result3 in resultset3 %}
                            {% for page2 in site.pages %}
                                {% if page2.rdf.iri == result3.resource.iri %}
                                <a class="dropdown-item" href="{{ page2.url }}">{{result3.name}}</a>
                                {% endif %}
                            {% endfor %}
                        {% endfor %}
                        </div>
                        {% endif %}
                    </li>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% endfor %}
    </ul>
</nav>
